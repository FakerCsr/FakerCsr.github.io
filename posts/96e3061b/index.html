<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>OWASP TOP 10 | FakerCsr's Magic Box</title><meta name="keywords" content="信息安全,漏洞介绍"><meta name="author" content="FakerCsr"><meta name="copyright" content="FakerCsr"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="OWASP TOP 10OWASP介绍 OWASP是一个开源的、非盈利的全球性安全组织，致力于应用软件的安全研究。我们的使命是使应用软件更加安全，使企业和组织能够对应用安全风险做出更清晰的决策。目前OWASP全球拥有250个分部近7万名会员，共同推动了安全标准、安全测试工具、安全指导手册等应用安全技术的发展。 OWASP在业界影响力  OWASP被视为web应用安全领域的权威参考。2009年下列发">
<meta property="og:type" content="article">
<meta property="og:title" content="OWASP TOP 10">
<meta property="og:url" content="http://fakercsr.github.io/posts/96e3061b/index.html">
<meta property="og:site_name" content="FakerCsr&#39;s Magic Box">
<meta property="og:description" content="OWASP TOP 10OWASP介绍 OWASP是一个开源的、非盈利的全球性安全组织，致力于应用软件的安全研究。我们的使命是使应用软件更加安全，使企业和组织能够对应用安全风险做出更清晰的决策。目前OWASP全球拥有250个分部近7万名会员，共同推动了安全标准、安全测试工具、安全指导手册等应用安全技术的发展。 OWASP在业界影响力  OWASP被视为web应用安全领域的权威参考。2009年下列发">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.traceable.ai/wp-content/uploads/2021/09/6039c84e695ede694324b40d_owaspcode-1.png">
<meta property="article:published_time" content="2021-12-02T07:07:59.000Z">
<meta property="article:modified_time" content="2021-12-02T07:27:49.430Z">
<meta property="article:author" content="FakerCsr">
<meta property="article:tag" content="信息安全">
<meta property="article:tag" content="漏洞介绍">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.traceable.ai/wp-content/uploads/2021/09/6039c84e695ede694324b40d_owaspcode-1.png"><link rel="shortcut icon" href="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png"><link rel="canonical" href="http://fakercsr.github.io/posts/96e3061b/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="manifest" href="/pwa/manifest.json"/><link rel="apple-touch-icon" sizes="180x180" href="/pwa/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/pwa/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/pwa/16.png"/><link rel="mask-icon" href="/pwa/safari-pinned-tab.svg" color="#5bbad5"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'OWASP TOP 10',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-12-02 15:27:49'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="./css/my.css"><style type="text/css">.app-refresh{position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease}.app-refresh-wrap{display:flex;color:#fff;height:100%;align-items:center;justify-content:center}.app-refresh-wrap a{color:#fff;text-decoration:underline;cursor:pointer}</style><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/./img/loading.gif" data-lazy-src="http://q1.qlogo.cn/g?b=qq&amp;nk=979280582&amp;s=640" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清單</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音樂</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 電影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 關於</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://www.traceable.ai/wp-content/uploads/2021/09/6039c84e695ede694324b40d_owaspcode-1.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">FakerCsr's Magic Box</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 時間軸</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 標籤</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分類</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清單</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音樂</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 電影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友鏈</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 關於</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">OWASP TOP 10</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-12-02T07:07:59.000Z" title="发表于 2021-12-02 15:07:59">2021-12-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-12-02T07:27:49.430Z" title="更新于 2021-12-02 15:27:49">2021-12-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/">信息安全</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="OWASP TOP 10"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="OWASP-TOP-10"><a href="#OWASP-TOP-10" class="headerlink" title="OWASP TOP 10"></a>OWASP TOP 10</h1><p><strong>OWASP介绍</strong></p>
<p>OWASP是一个开源的、非盈利的全球性安全组织，致力于应用软件的安全研究。我们的使命是使应用软件更加安全，使企业和组织能够对应用安全风险做出更清晰的决策。目前OWASP全球拥有250个分部近7万名会员，共同推动了安全标准、安全测试工具、安全指导手册等应用安全技术的发展。</p>
<p><strong>OWASP在业界影响力</strong></p>
<ul>
<li>OWASP被视为web应用安全领域的权威参考。2009年下列发布的美国国家和国际立法、标准、准则、委员会和行业实务守则参考引用了OWASP。美国联邦贸易委员会(FTC)强烈建议所有企业需遵循OWASP十大WEB弱点防护守则</li>
<li>国际信用卡数据安全技术PCI标准更将其列为必要组件</li>
<li>为美国国防信息系统局（DISA)应用安全和开发清单参考</li>
<li>为欧洲网络与信息安全局（ENISA), 云计算风险评估参考</li>
<li>为美国联邦首席信息官（CIO)理事会，联邦部门和机构使用社会媒体的安全指南</li>
<li>为美国国家安全局/中央安全局， 可管理的网络计划提供参考</li>
<li>为英国GovCERTUK提供SQL注入参考</li>
<li>为欧洲网络与信息安全局（ENISA), 云计算风险评估提供参考</li>
<li>OWASP TOP 10为IBM APPSCAN、HP WEBINSPECT等扫描器漏洞参考的主要标准</li>
</ul>
<h1 id="十大-Web-应用程序安全风险"><a href="#十大-Web-应用程序安全风险" class="headerlink" title="十大 Web 应用程序安全风险"></a>十大 Web 应用程序安全风险</h1><p>有三个新类别，四个类别的命名和范围发生了变化，并在 2021 年的前 10 名中进行了一些合并。</p>
<p><img src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211202144653.png" alt="image-20211202144653247"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/"><strong>A01:2021-Broken Access Control</strong></a>从第五位上升；94% 的应用程序都经过了某种形式的破坏访问控制的测试。映射到中断访问控制的 34 个常见弱点枚举 (CWE) 在应用程序中出现的次数比任何其他类别都多。</li>
<li><a target="_blank" rel="noopener" href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/"><strong>A02:2021-加密失败</strong></a>将排名上升一位至#2，以前称为敏感数据暴露，这是广泛的症状而不是根本原因。此处重新关注与密码学相关的故障，这些故障通常会导致敏感数据暴露或系统受损。</li>
<li><a target="_blank" rel="noopener" href="https://owasp.org/Top10/A03_2021-Injection/"><strong>A03:2021-Injection</strong></a>下滑至第三位。94% 的应用程序都针对某种形式的注入进行了测试，映射到此类别的 33 个 CWE 在应用程序中的出现次数排名第二。跨站点脚本现在是本版本中这一类别的一部分。</li>
<li><a target="_blank" rel="noopener" href="https://owasp.org/Top10/A04_2021-Insecure_Design/"><strong>A04:2021-不安全设计</strong></a>是<a target="_blank" rel="noopener" href="https://owasp.org/Top10/A04_2021-Insecure_Design/"><strong>2021 年的</strong></a>一个新类别，重点关注与设计缺陷相关的风险。如果我们真的想作为一个行业“向左移动”，就需要更多地使用威胁建模、安全设计模式和原则以及参考架构。</li>
<li><a target="_blank" rel="noopener" href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/"><strong>A05:2021-安全配置错误</strong></a>从上一版的第 6 位上升；90% 的应用程序都经过了某种形式的错误配置测试。随着更多转向高度可配置的软件，看到这一类别上升也就不足为奇了。XML 外部实体 (XXE) 的前一个类别现在属于此类别。</li>
<li><a target="_blank" rel="noopener" href="https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/"><strong>A06:2021-Vulnerable and Outdated Components</strong></a>之前的标题是使用具有已知漏洞的组件，在前 10 名社区调查中排名第二，但也有足够的数据通过数据分析进入前 10 名。该类别从 2017 年的第 9 位上升，是我们难以测试和评估风险的已知问题。它是唯一没有任何常见漏洞和暴露 (CVE) 映射到包含的 CWE 的类别，因此默认的利用和影响权重 5.0 被计入它们的分数。</li>
<li><a target="_blank" rel="noopener" href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/"><strong>A07:2021-Identification and Authentication Failures</strong></a>之前是 Broken Authentication 并且从第二位下滑，现在包括与识别失败更多相关的 CWE。这个类别仍然是前 10 名的一个组成部分，但标准化框架的可用性增加似乎有所帮助。</li>
<li><a target="_blank" rel="noopener" href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"><strong>A08:2021-软件和数据完整性故障</strong></a>是 2021 年的一个新类别，专注于在不验证完整性的情况下做出与软件更新、关键数据和 CI/CD 管道相关的假设。来自常见漏洞和暴露/常见漏洞评分系统 (CVE/CVSS) 数据的最高加权影响之一映射到该类别中的 10 个 CWE。2017 年的不安全反序列化现在是这个更大类别的一部分。</li>
<li><a target="_blank" rel="noopener" href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"><strong>A09:2021-安全日志记录和监控失败</strong></a>以前是<a target="_blank" rel="noopener" href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/"><strong>日志记录和监控</strong></a>不足，是从行业调查 (#3) 中添加的，从之前的 #10 上升。此类别已扩展为包括更多类型的故障，难以测试，并且在 CVE/CVSS 数据中没有得到很好的体现。但是，此类故障会直接影响可见性、事件警报和取证。</li>
<li><a target="_blank" rel="noopener" href="https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_(SSRF)/"><strong>A10:2021-Server-Side Request Forgery</strong></a>添加自 Top 10 社区调查 (#1)。数据显示发生率相对较低，测试覆盖率高于平均水平，并且利用和影响潜力的评级高于平均水平。此类别代表安全社区成员告诉我们这很重要的场景，即使目前数据中没有说明这一点。</li>
</ul>
<p><img src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211202144832.png" alt="image-20211202144832765"></p>
<p>有很多关于十大风险之间重叠的讨论。根据每个（包括 CWE 列表）的定义，确实没有任何重叠。但是，从概念上讲，可能存在基于更高级别命名的重叠或交互。维恩图多次用于显示这样的重叠。</p>
<p>上面的维恩图代表了 2017 年十大风险类别之间的相互作用。</p>
<h1 id="A01-2021-–-损坏的访问控制"><a href="#A01-2021-–-损坏的访问控制" class="headerlink" title="A01:2021 – 损坏的访问控制"></a>A01:2021 – 损坏的访问控制</h1><p><img src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211202150620.png" alt="图标"></p>
<h2 id="因素"><a href="#因素" class="headerlink" title="因素"></a>因素</h2><table>
<thead>
<tr>
<th>映射的 CWE</th>
<th>最大发生率</th>
<th>平均发生率</th>
<th>平均加权漏洞利用</th>
<th>平均加权影响</th>
<th>最大覆盖范围</th>
<th>平均覆盖率</th>
<th>总发生次数</th>
<th>CVE 总数</th>
</tr>
</thead>
<tbody><tr>
<td>34</td>
<td>55.97%</td>
<td>3.81%</td>
<td>6.92</td>
<td>5.93</td>
<td>94.55%</td>
<td>47.72%</td>
<td>318,487</td>
<td>19,013</td>
</tr>
</tbody></table>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>从第五位上升，94% 的应用程序接受了某种形式的访问控制损坏测试，平均发生率为 3.81%，在贡献的数据集中出现次数最多，超过 318k。值得注意的常见弱点枚举 (CWE) 包括<em>CWE-200：将敏感信息暴露给未经授权的</em>参与者、<em>CWE-201：通过发送的数据暴露敏感信息</em>和<em>CWE-352：跨站点请求伪造</em>。</p>
<h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>访问控制强制执行策略，使用户不能在其预期权限之外采取行动。故障通常会导致未经授权的信息泄露、修改或破坏所有数据或执行超出用户限制的业务功能。常见的访问控制漏洞包括：</p>
<ul>
<li>违反最小权限原则或默认拒绝，其中访问权限仅授予特定功能、角色或用户，但可供任何人使用。</li>
<li>通过修改 URL（参数篡改或强制浏览）、内部应用程序状态或 HTML 页面，或使用攻击工具修改 API 请求来绕过访问控制检查。</li>
<li>通过提供其唯一标识符（不安全的直接对象引用）来允许查看或编辑其他人的帐户</li>
<li>访问 API 时缺少对 POST、PUT 和 DELETE 的访问控制。</li>
<li>特权提升。以用户身份而不登录或以用户身份登录时充当管理员。</li>
<li>元数据操作，例如重放或篡改 JSON Web 令牌 (JWT) 访问控制令牌，或用于提升权限或滥用 JWT 失效的 cookie 或隐藏字段。</li>
<li>CORS 错误配置允许来自未经授权/不受信任的来源的 API 访问。</li>
<li>强制以未经身份验证的用户身份浏览经过身份验证的页面或以标准用户身份浏览特权页面。</li>
</ul>
<h2 id="如何预防"><a href="#如何预防" class="headerlink" title="如何预防"></a>如何预防</h2><p>访问控制仅在受信任的服务器端代码或无服务器 API 中有效，攻击者无法修改访问控制检查或元数据。</p>
<ul>
<li>除公共资源外，默认拒绝。</li>
<li>实施一次访问控制机制并在整个应用程序中重复使用它们，包括最大限度地减少跨源资源共享 (CORS) 的使用。</li>
<li>模型访问控制应该强制记录所有权，而不是接受用户可以创建、读取、更新或删除任何记录。</li>
<li>独特的应用程序业务限制要求应由领域模型强制执行。</li>
<li>禁用 Web 服务器目录列表并确保文件元数据（例如 .git）和备份文件不在 Web 根目录中。</li>
<li>记录访问控制失败，在适当时提醒管理员（例如，重复失败）。</li>
<li>速率限制 API 和控制器访问，以最大限度地减少自动攻击工具的危害。</li>
<li>注销后，服务器上的有状态会话标识符应失效。无状态 JWT 令牌应该是短暂的，以便最大限度地减少攻击者的机会窗口。对于寿命较长的 JWT，强烈建议遵循 OAuth 标准来撤销访问。</li>
</ul>
<p>开发人员和 QA 人员应包括功能访问控制单元和集成测试。</p>
<h2 id="示例攻击场景"><a href="#示例攻击场景" class="headerlink" title="示例攻击场景"></a>示例攻击场景</h2><p><strong>场景 #1：</strong>应用程序在访问帐户信息的 SQL 调用中使用未经验证的数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pstmt.setString(1, request.getParameter(&quot;acct&quot;));</span><br><span class="line">ResultSet results = pstmt.executeQuery( );</span><br></pre></td></tr></table></figure>

<p>攻击者只需修改浏览器的“acct”参数即可发送他们想要的任何帐号。如果没有正确验证，攻击者可以访问任何用户的帐户。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://example.com/app/accountInfo?acct=notmyacct</span><br></pre></td></tr></table></figure>

<p><strong>场景#2：</strong>攻击者只是强制浏览到目标 URL。访问管理页面需要管理员权限。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://example.com/app/getappInfo</span><br><span class="line">https://example.com/app/admin_getappInfo</span><br></pre></td></tr></table></figure>

<p>如果未经身份验证的用户可以访问任一页面，则这是一个缺陷。如果非管理员可以访问管理页面，这是一个缺陷。</p>
<h1 id="A02-2021-–-加密失败"><a href="#A02-2021-–-加密失败" class="headerlink" title="A02:2021 – 加密失败"></a>A02:2021 – 加密失败</h1><p><img src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211202151410.png" alt="图标"></p>
<h2 id="因素-1"><a href="#因素-1" class="headerlink" title="因素"></a>因素</h2><table>
<thead>
<tr>
<th>映射的 CWE</th>
<th>最大发生率</th>
<th>平均发生率</th>
<th>平均加权漏洞利用</th>
<th>平均加权影响</th>
<th>最大覆盖范围</th>
<th>平均覆盖率</th>
<th>总发生次数</th>
<th>CVE 总数</th>
</tr>
</thead>
<tbody><tr>
<td>29</td>
<td>46.44%</td>
<td>4.49%</td>
<td>7.29</td>
<td>6.81</td>
<td>79.33%</td>
<td>34.85%</td>
<td>233,788</td>
<td>3,075</td>
</tr>
</tbody></table>
<h2 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h2><p>上移一个位置到#2，以前称为<em>敏感数据暴露</em>，这更像是一种广泛的症状而不是根本原因，重点是与密码学（或缺乏密码学）相关的故障。这往往会导致敏感数据的暴露。包括的值得注意的常见弱点枚举 (CWE) 包括<em>CWE-259：使用硬编码密码</em>、<em>CWE-327：损坏或有风险的加密算法</em>和<em>CWE-331 熵不足</em>。</p>
<h2 id="描述-1"><a href="#描述-1" class="headerlink" title="描述"></a>描述</h2><p>首先是确定传输中和静止数据的保护需求。例如，密码、信用卡号、健康记录、个人信息和商业秘密需要额外保护，主要是如果该数据属于隐私法（例如欧盟的通用数据保护条例 (GDPR)）或法规（例如金融数据保护）例如 PCI 数据安全标准 (PCI DSS)。对于所有此类数据：</p>
<ul>
<li>是否有任何数据以明文传输？这涉及 HTTP、SMTP、FTP 等协议也使用 TLS 升级，如 STARTTLS。外部互联网流量是危险的。验证所有内部流量，例如，负载平衡器、Web 服务器或后端系统之间的流量。</li>
<li>默认情况下或在较旧的代码中是否使用任何旧的或弱的加密算法或协议？</li>
<li>是否正在使用默认加密密钥、生成或重复使用弱加密密钥，或者是否缺少适当的密钥管理或轮换？加密密钥是否已签入源代码存储库？</li>
<li>是否未强制执行加密，例如，是否缺少任何 HTTP 标头（浏览器）安全指令或标头？</li>
<li>收到的服务器证书和信任链是否经过正确验证？</li>
<li>对于加密操作模式，初始化向量是否被忽略、重用或没有足够安全地生成？是否正在使用不安全的操作模式，例如欧洲央行？当认证加密更合适时是否使用加密？</li>
<li>在没有密码基密钥派生函数的情况下，是否将密码用作加密密钥？</li>
<li>随机性是否用于并非旨在满足加密要求的加密目的？即使选择了正确的功能，它是否需要由开发人员播种，如果不需要，开发人员是否用缺乏足够熵/不可预测性的种子覆盖了内置的强大播种功能？</li>
<li>是否使用过时的哈希函数，例如 MD5 或 SHA1，或者在需要加密哈希函数时使用非加密哈希函数？</li>
<li>是否在使用已弃用的加密填充方法，例如 PKCS number 1 v1.5？</li>
<li>加密错误消息或边信道信息是否可利用，例如以填充预言机攻击的形式？</li>
</ul>
<p>请参阅 ASVS 加密 (V7)、数据保护 (V9) 和 SSL/TLS (V10)</p>
<h2 id="如何预防-1"><a href="#如何预防-1" class="headerlink" title="如何预防"></a>如何预防</h2><p>至少执行以下操作，并查阅参考资料：</p>
<ul>
<li>对应用程序处理、存储或传输的数据进行分类。根据隐私法、监管要求或业务需求确定哪些数据是敏感的。</li>
<li>不要不必要地存储敏感数据。尽快丢弃它或使用符合 PCI DSS 的标记化甚至截断。未保留的数据不能被窃取。</li>
<li>确保加密所有静态敏感数据。</li>
<li>确保拥有最新且强大的标准算法、协议和密钥；使用适当的密钥管理。</li>
<li>使用安全协议（例如具有前向保密 (FS) 密码的 TLS、服务器的密码优先级和安全参数）加密所有传输中的数据。使用 HTTP 严格传输安全 (HSTS) 等指令强制加密。</li>
<li>对包含敏感数据的响应禁用缓存。</li>
<li>根据数据分类应用所需的安全控制。</li>
<li>不要使用传统协议（例如 FTP 和 SMTP）来传输敏感数据。</li>
<li>使用具有工作因子（延迟因子）的强自适应和加盐散列函数存储密码，例如 Argon2、scrypt、bcrypt 或 PBKDF2。</li>
<li>必须选择适合操作模式的初始化向量。对于许多模式，这意味着使用 CSPRNG（密码安全伪随机数生成器）。对于需要随机数的模式，则初始化向量 (IV) 不需要 CSPRNG。在所有情况下，对于一个固定键，IV 永远不应该被使用两次。</li>
<li>始终使用经过身份验证的加密，而不仅仅是加密。</li>
<li>密钥应该以加密方式随机生成并作为字节数组存储在内存中。如果使用密码，则必须通过适当的密码基密钥派生函数将其转换为密钥。</li>
<li>确保在适当的地方使用加密随机性，并且没有以可预测的方式或低熵播种。大多数现代 API 不需要开发人员为 CSPRNG 设置种子以获得安全性。</li>
<li>避免不推荐使用的加密函数和填充方案，例如 MD5、SHA1、PKCS number 1 v1.5。</li>
<li>独立验证配置和设置的有效性。</li>
</ul>
<h2 id="示例攻击场景-1"><a href="#示例攻击场景-1" class="headerlink" title="示例攻击场景"></a>示例攻击场景</h2><p><strong>场景#1</strong>：应用程序使用自动数据库加密对数据库中的信用卡号进行加密。但是，这些数据在检索时会自动解密，从而允许 SQL 注入缺陷以明文形式检索信用卡号。</p>
<p><strong>场景#2</strong>：站点不会对所有页面使用或强制执行 TLS 或支持弱加密。攻击者监视网络流量（例如，在不安全的无线网络中），将连接从 HTTPS 降级为 HTTP，拦截请求并窃取用户的会话 cookie。然后攻击者重放这个 cookie 并劫持用户的（经过身份验证的）会话，访问或修改用户的私人数据。除了上述之外，他们还可以更改所有传输的数据，例如，汇款的接收者。</p>
<p><strong>场景#3</strong>：密码数据库使用未加盐或简单的哈希来存储每个人的密码。文件上传缺陷允许攻击者检索密码数据库。所有未加盐的哈希值都可以通过预先计算的哈希值彩虹表公开。由简单或快速散列函数生成的散列可能会被 GPU 破解，即使它们被加盐。</p>
<h1 id="A03-2021-–-注射"><a href="#A03-2021-–-注射" class="headerlink" title="A03:2021 – 注射"></a>A03:2021 – 注射</h1><p><img src= "/./img/loading.gif" data-lazy-src="https://owasp.org/Top10/assets/TOP_10_Icons_Final_Injection.png" alt="图标"></p>
<h2 id="因素-2"><a href="#因素-2" class="headerlink" title="因素"></a>因素</h2><table>
<thead>
<tr>
<th>映射的 CWE</th>
<th>最大发生率</th>
<th>平均发生率</th>
<th>平均加权漏洞利用</th>
<th>平均加权影响</th>
<th>最大覆盖范围</th>
<th>平均覆盖率</th>
<th>总发生次数</th>
<th>CVE 总数</th>
</tr>
</thead>
<tbody><tr>
<td>33</td>
<td>19.09%</td>
<td>3.37%</td>
<td>7.25</td>
<td>7.15</td>
<td>94.04%</td>
<td>47.90%</td>
<td>274,228</td>
<td>32,078</td>
</tr>
</tbody></table>
<h2 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h2><p>注射向下滑动到第三个位置。94% 的应用程序针对某种形式的注射进行了测试，最大发生率为 19%，平均发生率为 3%，出现次数为 274k。值得注意的常见弱点枚举 (CWE) 包括 <em>CWE-79：跨站点脚本</em>、<em>CWE-89：SQL 注入</em>和<em>CWE-73：文件名或路径的外部控制</em>。</p>
<h2 id="描述-2"><a href="#描述-2" class="headerlink" title="描述"></a>描述</h2><p>应用程序在以下情况下容易受到攻击：</p>
<ul>
<li>应用程序不会验证、过滤或清理用户提供的数据。</li>
<li>没有上下文感知转义的动态查询或非参数化调用直接在解释器中使用。</li>
<li>在对象关系映射 (ORM) 搜索参数中使用恶意数据来提取额外的敏感记录。</li>
<li>直接使用或连接恶意数据。SQL 或命令包含动态查询、命令或存储过程中的结构和恶意数据。</li>
</ul>
<p>一些更常见的注入是 SQL、NoSQL、OS 命令、对象关系映射 (ORM)、LDAP 和表达式语言 (EL) 或对象图导航库 (OGNL) 注入。这个概念在所有口译员中都是相同的。源代码审查是检测应用程序是否容易受到注入攻击的最佳方法。强烈鼓励对所有参数、标头、URL、cookie、JSON、SOAP 和 XML 数据输入进行自动化测试。组织可以在 CI/CD 管道中包含静态 (SAST)、动态 (DAST) 和交互式 (IAST) 应用程序安全测试工具，以在生产部署之前识别引入的注入缺陷。</p>
<h2 id="如何预防-2"><a href="#如何预防-2" class="headerlink" title="如何预防"></a>如何预防</h2><p>防止注入需要将数据与命令和查询分开：</p>
<ul>
<li>首选选项是使用安全的 API，它完全避免使用解释器，提供参数化接口，或迁移到对象关系映射工具 (ORM)。<br><strong>注意：</strong>即使在参数化时，如果 PL/SQL 或 T-SQL 连接查询和数据或使用 EXECUTE IMMEDIATE 或 exec() 执行恶意数据，则存储过程仍然会引入 SQL 注入。</li>
<li>使用积极的服务器端输入验证。这不是一个完整的防御，因为许多应用程序需要特殊字符，例如文本区域或移动应用程序的 API。</li>
<li>对于任何残留的动态查询，使用该解释器的特定转义语法转义特殊字符。<br><strong>注意：</strong>表名、列名等 SQL 结构不能转义，因此用户提供的结构名是危险的。这是报告编写软件中的常见问题。</li>
<li>在查询中使用 LIMIT 和其他 SQL 控件以防止在 SQL 注入的情况下大量披露记录。</li>
</ul>
<h2 id="示例攻击场景-2"><a href="#示例攻击场景-2" class="headerlink" title="示例攻击场景"></a>示例攻击场景</h2><p><strong>场景 #1：</strong>应用程序在构建以下易受攻击的 SQL 调用时使用不受信任的数据：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String query = &quot;SELECT \* FROM accounts WHERE custID=&#x27;&quot; + request.getParameter(&quot;id&quot;) + &quot;&#x27;&quot;;</span><br></pre></td></tr></table></figure>

<p><strong>场景#2：</strong>类似地，应用程序对框架的盲目信任可能会导致查询仍然存在漏洞（例如，Hibernate 查询语言 (HQL)）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Query HQLQuery = session.createQuery(&quot;FROM accounts WHERE custID=&#x27;&quot; + request.getParameter(&quot;id&quot;) + &quot;&#x27;&quot;);</span><br></pre></td></tr></table></figure>

<p>在这两种情况下，攻击者都会修改浏览器中的 ‘id’ 参数值以发送：’ 或 ‘1’=’1。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://example.com/app/accountView?id=&#x27; or &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<p>这将更改两个查询的含义，以返回帐户表中的所有记录。更危险的攻击可能会修改或删除数据，甚至调用存储过程。</p>
<h1 id="A04-2021-–-不安全的设计"><a href="#A04-2021-–-不安全的设计" class="headerlink" title="A04:2021 – 不安全的设计"></a>A04:2021 – 不安全的设计</h1><p><img src= "/./img/loading.gif" data-lazy-src="https://owasp.org/Top10/assets/TOP_10_Icons_Final_Insecure_Design.png" alt="图标"></p>
<h2 id="因素-3"><a href="#因素-3" class="headerlink" title="因素"></a>因素</h2><table>
<thead>
<tr>
<th>映射的 CWE</th>
<th>最大发生率</th>
<th>平均发生率</th>
<th>平均加权漏洞利用</th>
<th>平均加权影响</th>
<th>最大覆盖范围</th>
<th>平均覆盖率</th>
<th>总发生次数</th>
<th>CVE 总数</th>
</tr>
</thead>
<tbody><tr>
<td>40</td>
<td>24.19%</td>
<td>3.00%</td>
<td>6.46</td>
<td>6.78</td>
<td>77.25%</td>
<td>42.51%</td>
<td>262,407</td>
<td>2,691</td>
</tr>
</tbody></table>
<h2 id="概述-3"><a href="#概述-3" class="headerlink" title="概述"></a>概述</h2><p>2021 年的新类别侧重于与设计和架构缺陷相关的风险，并呼吁更多地使用威胁建模、安全设计模式和参考架构。作为一个社区，我们需要超越编码空间中的“左移”，以预编码对设计安全原则至关重要的活动。值得注意的常见弱点枚举 ( <em>CWE</em> ) 包括<em>CWE-209：生成包含敏感信息的错误消息</em>、<em>CWE-256：未受保护的凭证存储</em>、<em>CWE-501：信任边界违规</em>和<em>CWE-522：受保护的凭证不足</em>。</p>
<h2 id="描述-3"><a href="#描述-3" class="headerlink" title="描述"></a>描述</h2><p>不安全设计是一个广泛的类别，代表不同的弱点，表示为“缺失或无效的控制设计”。不安全的设计并不是所有其他 10 大风险类别的来源。不安全的设计和不安全的实现之间是有区别的。我们区分设计缺陷和实施缺陷是有原因的，它们有不同的根本原因和补救措施。安全设计仍可能存在实现缺陷，从而导致可能被利用的漏洞。不安全的设计无法通过完美的实现来修复，因为根据定义，从来没有创建所需的安全控制来防御特定的攻击。导致设计不安全的因素之一是正在开发的软件或系统中缺乏固有的业务风险分析，</p>
<h2 id="需求和资源管理"><a href="#需求和资源管理" class="headerlink" title="需求和资源管理"></a>需求和资源管理</h2><p>收集并与企业协商应用程序的业务需求，包括有关所有数据资产的机密性、完整性、可用性和真实性以及预期业务逻辑的保护要求。考虑您的应用程序的公开程度以及您是否需要隔离租户（此外还需要访问控制）。编译技术要求，包括功能性和非功能性安全要求。规划和协商涵盖所有设计、构建、测试和运营（包括安全活动）的预算。</p>
<h2 id="安全设计"><a href="#安全设计" class="headerlink" title="安全设计"></a>安全设计</h2><p>安全设计是一种文化和方法，它不断评估威胁并确保代码经过稳健设计和测试，以防止已知的攻击方法。威胁建模应整合到细化会议（或类似活动）中；寻找数据流和访问控制或其他安全控制的变化。在用户故事开发中，确定正确的流程和故障状态，确保责任方和受影响方充分理解并同意它们。分析预期和失败流的假设和条件，确保它们仍然准确和可取。确定如何验证假设并强制执行正确行为所需的条件。确保结果记录在用户故事中。从错误中学习并提供积极的激励措施来促进改进。</p>
<h2 id="安全开发生命周期"><a href="#安全开发生命周期" class="headerlink" title="安全开发生命周期"></a>安全开发生命周期</h2><p>安全软件需要安全的开发生命周期、某种形式的安全设计模式、铺好的道路方法、安全的组件库、工具和威胁建模。在整个项目和软件维护过程中，在软件项目开始时联系您的安全专家。考虑利用<a target="_blank" rel="noopener" href="https://owaspsamm.org/">OWASP 软件保障成熟度模型 (SAMM)</a>来帮助构建您的安全软件开发工作。</p>
<h2 id="如何预防-3"><a href="#如何预防-3" class="headerlink" title="如何预防"></a>如何预防</h2><ul>
<li>与 AppSec 专业人员建立并使用安全的开发生命周期，以帮助评估和设计安全和隐私相关的控制</li>
<li>建立和使用安全设计模式库或准备使用组件的铺好的道路</li>
<li>将威胁建模用于关键身份验证、访问控制、业务逻辑和关键流</li>
<li>将安全语言和控件集成到用户故事中</li>
<li>在应用程序的每一层（从前端到后端）集成合理性检查</li>
<li>编写单元和集成测试以验证所有关键流都能抵抗威胁模型。为应用程序的每一层编译用例<em>和</em>误用用例。</li>
<li>根据暴露和保护需求分离系统层和网络层上的层</li>
<li>通过设计在所有层中强有力地隔离租户</li>
<li>限制用户或服务的资源消耗</li>
</ul>
<h2 id="示例攻击场景-3"><a href="#示例攻击场景-3" class="headerlink" title="示例攻击场景"></a>示例攻击场景</h2><p><strong>场景 #1：</strong>凭证恢复工作流可能包括“问答”，这是 NIST 800-63b、OWASP ASVS 和 OWASP Top 10 所禁止的。不能将问答作为多个人身份的证据可以知道答案，这就是为什么它们被禁止。应删除此类代码并用更安全的设计替换。</p>
<p><strong>场景#2：</strong>连锁影院允许团体预订折扣，并且在要求押金之前最多有 15 名参与者。攻击者可以对该流程进行威胁建模，并测试他们是否可以在几次请求中一次预订 600 个座位和所有电影院，从而造成巨大的收入损失。</p>
<p><strong>场景 #3：</strong>零售连锁店的电子商务网站没有针对由黄牛运行的机器人提供保护，这些机器人购买高端显卡以转售拍卖网站。这对视频卡制造商和零售连锁店主造成了可怕的宣传，并与无法以任何价格获得这些卡的爱好者之间产生了仇恨。仔细的反机器人设计和域逻辑规则，例如在可用性的几秒钟内进行的购买，可能会识别出不真实的购买并拒绝此类交易。</p>
<h1 id="A05-2021-–-安全配置错误"><a href="#A05-2021-–-安全配置错误" class="headerlink" title="A05:2021 – 安全配置错误"></a>A05:2021 – 安全配置错误</h1><p><img src= "/./img/loading.gif" data-lazy-src="https://owasp.org/Top10/assets/TOP_10_Icons_Final_Security_Misconfiguration.png" alt="图标"></p>
<h2 id="因素-4"><a href="#因素-4" class="headerlink" title="因素"></a>因素</h2><table>
<thead>
<tr>
<th>映射的 CWE</th>
<th>最大发生率</th>
<th>平均发生率</th>
<th>平均加权漏洞利用</th>
<th>平均加权影响</th>
<th>最大覆盖范围</th>
<th>平均覆盖率</th>
<th>总发生次数</th>
<th>CVE 总数</th>
</tr>
</thead>
<tbody><tr>
<td>20</td>
<td>19.84%</td>
<td>4.51%</td>
<td>8.12</td>
<td>6.56</td>
<td>89.58%</td>
<td>44.84%</td>
<td>208,387</td>
<td>789</td>
</tr>
</tbody></table>
<h2 id="概述-4"><a href="#概述-4" class="headerlink" title="概述"></a>概述</h2><p>从上一版中的#6 开始，90% 的应用程序都接受了某种形式的错误配置测试，平均发生率为 4.%，并且在此风险类别中出现了超过 208k 次常见弱点枚举 (CWE)。随着更多转向高度可配置的软件，看到这一类别上升也就不足为奇了。值得注意的<em>CWE</em>包括<em>CWE-16 配置</em>和<em>CWE-611 XML 外部实体引用的不当限制</em>。</p>
<h2 id="描述-4"><a href="#描述-4" class="headerlink" title="描述"></a>描述</h2><p>如果应用程序是：</p>
<ul>
<li>在应用程序堆栈的任何部分缺少适当的安全强化或对云服务的权限配置不正确。</li>
<li>启用或安装了不必要的功能（例如，不必要的端口、服务、页面、帐户或权限）。</li>
<li>默认帐户及其密码仍处于启用状态且未更改。</li>
<li>错误处理向用户显示堆栈跟踪或其他信息过多的错误消息。</li>
<li>对于升级的系统，最新的安全功能被禁用或未安全配置。</li>
<li>应用程序服务器、应用程序框架（例如，Struts、Spring、ASP.NET）、库、数据库等中的安全设置未设置为安全值。</li>
<li>服务器不发送安全标头或指令，或者它们未设置为安全值。</li>
<li>软件已过时或易受攻击（请参阅<a target="_blank" rel="noopener" href="https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/">A06:2021-易受攻击和过时的组件</a>）。</li>
</ul>
<p>如果没有协调一致的、可重复的应用程序安全配置过程，系统将面临更高的风险。</p>
<h2 id="如何预防-4"><a href="#如何预防-4" class="headerlink" title="如何预防"></a>如何预防</h2><p>应实施安全安装过程，包括：</p>
<ul>
<li>可重复的强化过程使部署另一个适当锁定的环境变得快速而轻松。开发、QA 和生产环境都应配置相同，在每个环境中使用不同的凭据。此过程应自动化，以最大限度地减少设置新安全环境所需的工作。</li>
<li>一个没有任何不必要的功能、组件、文档和示例的最小平台。删除或不安装未使用的功能和框架。</li>
<li>作为补丁管理流程的一部分，审查和更新适用于所有安全说明、更新和补丁的配置的任务（请参阅<a target="_blank" rel="noopener" href="https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/">A06:2021-易受攻击和过时的组件</a>）。查看云存储权限（例如，S3 存储桶权限）。</li>
<li>分段应用程序架构通过分段、容器化或云安全组 (ACL) 在组件或租户之间提供有效且安全的分离。</li>
<li>向客户端发送安全指令，例如安全标头。</li>
<li>验证配置和设置在所有环境中的有效性的自动化过程。</li>
</ul>
<h2 id="示例攻击场景-4"><a href="#示例攻击场景-4" class="headerlink" title="示例攻击场景"></a>示例攻击场景</h2><p><strong>场景#1：</strong>应用程序服务器带有未从生产服务器中删除的示例应用程序。这些示例应用程序具有攻击者用来破坏服务器的已知安全漏洞。假设这些应用程序之一是管理控制台，并且默认帐户未更改。在这种情况下，攻击者使用默认密码登录并接管。</p>
<p><strong>场景#2：</strong>服务器上没有禁用目录列表。攻击者发现他们可以简单地列出目录。攻击者找到并下载编译好的Java类，对其进行反编译和逆向工程以查看代码。然后攻击者发现应用程序中存在严重的访问控制缺陷。</p>
<p><strong>场景#3：</strong>应用服务器的配置允许将详细的错误消息（例如堆栈跟踪）返回给用户。这可能会暴露敏感信息或潜在缺陷，例如已知易受攻击的组件版本。</p>
<p><strong>场景 #4：</strong>云服务提供商 (CSP) 具有其他 CSP 用户对 Internet 开放的默认共享权限。这允许访问存储在云存储中的敏感数据。</p>
<h1 id="A06-2021-–-易受攻击和过时的组件"><a href="#A06-2021-–-易受攻击和过时的组件" class="headerlink" title="A06:2021 – 易受攻击和过时的组件"></a>A06:2021 – 易受攻击和过时的组件</h1><p><img src= "/./img/loading.gif" data-lazy-src="https://owasp.org/Top10/assets/TOP_10_Icons_Final_Vulnerable_Outdated_Components.png" alt="图标"></p>
<h2 id="因素-5"><a href="#因素-5" class="headerlink" title="因素"></a>因素</h2><table>
<thead>
<tr>
<th>映射的 CWE</th>
<th>最大发生率</th>
<th>平均发生率</th>
<th>最大覆盖范围</th>
<th>平均覆盖率</th>
<th>平均加权漏洞利用</th>
<th>平均加权影响</th>
<th>总发生次数</th>
<th>CVE 总数</th>
</tr>
</thead>
<tbody><tr>
<td>3</td>
<td>27.96%</td>
<td>8.77%</td>
<td>51.78%</td>
<td>22.47%</td>
<td>5.00</td>
<td>5.00</td>
<td>30,457</td>
<td>0</td>
</tr>
</tbody></table>
<h2 id="概述-5"><a href="#概述-5" class="headerlink" title="概述"></a>概述</h2><p>它在前 10 名社区调查中排名第二，但也有足够的数据通过数据进入前 10 名。易受攻击的组件是我们难以测试和评估风险的已知问题，并且是唯一没有任何常见弱点枚举 (CWE) 映射到包含的 CWE 的类别，因此使用了默认的漏洞利用/影响权重 5.0。值得注意的<em>CWE</em>包括<em>CWE-1104：使用未维护的第三方组件</em>和来自 2013 年和 2017 年前 10 名的两个 CWE。</p>
<h2 id="描述-5"><a href="#描述-5" class="headerlink" title="描述"></a>描述</h2><p>你可能很脆弱：</p>
<ul>
<li>如果您不知道您使用的所有组件的版本（客户端和服务器端）。这包括您直接使用的组件以及嵌套的依赖项。</li>
<li>如果软件易受攻击、不受支持或已过期。这包括操作系统、Web/应用程序服务器、数据库管理系统 (DBMS)、应用程序、API 和所有组件、运行时环境和库。</li>
<li>如果您不定期扫描漏洞并订阅与您使用的组件相关的安全公告。</li>
<li>如果您没有以基于风险的方式及时修复或升级底层平台、框架和依赖项。这通常发生在修补是变更控制下的每月或每季度任务的环境中，使组织面临数天或数月不必要地暴露于固定漏洞的风险。</li>
<li>如果软件开发人员不测试更新、升级或打补丁的库的兼容性。</li>
<li>如果您不保护组件的配置（请参阅 A05:2021-安全配置错误）。</li>
</ul>
<h2 id="如何预防-5"><a href="#如何预防-5" class="headerlink" title="如何预防"></a>如何预防</h2><p>应该有一个补丁管理流程来：</p>
<ul>
<li>删除未使用的依赖项、不必要的功能、组件、文件和文档。</li>
<li>使用版本、OWASP 依赖项检查、retire.js 等工具持续清点客户端和服务器端组件（例如框架、库）及其依赖项的版本。持续监控常见漏洞和暴露 (CVE) 等来源和国家漏洞数据库 (NVD) 以获取组件中的漏洞。使用软件组合分析工具来自动化该过程。订阅与您使用的组件相关的安全漏洞的电子邮件警报。</li>
<li>仅通过安全链接从官方来源获取组件。首选签名包以减少包含修改后的恶意组件的机会（请参阅 A08:2021-软件和数据完整性故障）。</li>
<li>监视未维护或未为旧版本创建安全补丁的库和组件。如果无法打补丁，请考虑部署虚拟补丁来监控、检测或防止发现的问题。</li>
</ul>
<p>每个组织都必须确保在应用程序或产品组合的生命周期内制定持续的监控、分类和应用更新或配置更改的计划。</p>
<h2 id="示例攻击场景-5"><a href="#示例攻击场景-5" class="headerlink" title="示例攻击场景"></a>示例攻击场景</h2><p><strong>场景#1：</strong>组件通常以与应用程序本身相同的权限运行，因此任何组件中的缺陷都可能导致严重影响。此类缺陷可能是偶然的（例如，编码错误）或有意的（例如，组件中的后门）。发现的一些可利用组件漏洞的示例是：</p>
<ul>
<li>CVE-2017-5638 是一个 Struts 2 远程代码执行漏洞，可以在服务器上执行任意代码，已被归咎于重大漏洞。</li>
<li>虽然物联网 (IoT) 通常很难或不可能修补，但修补它们的重要性可能很大（例如，生物医学设备）。</li>
</ul>
<p>有一些自动化工具可以帮助攻击者找到未打补丁或配置错误的系统。例如，Shodan IoT 搜索引擎可以帮助您找到仍然存在 2014 年 4 月修补的 Heartbleed 漏洞的设备。</p>
<h1 id="A07-2021-–-识别和认证失败"><a href="#A07-2021-–-识别和认证失败" class="headerlink" title="A07:2021 – 识别和认证失败"></a>A07:2021 – 识别和认证失败</h1><p><img src= "/./img/loading.gif" data-lazy-src="https://owasp.org/Top10/assets/TOP_10_Icons_Final_Identification_and_Authentication_Failures.png" alt="图标"></p>
<h2 id="因素-6"><a href="#因素-6" class="headerlink" title="因素"></a>因素</h2><table>
<thead>
<tr>
<th>映射的 CWE</th>
<th>最大发生率</th>
<th>平均发生率</th>
<th>平均加权漏洞利用</th>
<th>平均加权影响</th>
<th>最大覆盖范围</th>
<th>平均覆盖率</th>
<th>总发生次数</th>
<th>CVE 总数</th>
</tr>
</thead>
<tbody><tr>
<td>22</td>
<td>14.84%</td>
<td>2.55%</td>
<td>7.40</td>
<td>6.50</td>
<td>79.51%</td>
<td>45.72%</td>
<td>132,195</td>
<td>3,897</td>
</tr>
</tbody></table>
<h2 id="概述-6"><a href="#概述-6" class="headerlink" title="概述"></a>概述</h2><p>以前称为<em>Broken Authentication</em>，此类别从第二位下滑，现在包括与识别失败相关的常见弱点枚举 (CWE)。包括的值得注意的<em>CWE</em>包括<em>CWE-297：不正确的证书验证与主机不匹配</em>、<em>CWE-287：不正确的身份验证</em>和 <em>CWE-384：会话固定</em>。</p>
<h2 id="描述-6"><a href="#描述-6" class="headerlink" title="描述"></a>描述</h2><p>确认用户的身份、身份验证和会话管理对于防止与身份验证相关的攻击至关重要。如果应用程序存在以下情况，则可能存在身份验证漏洞：</p>
<ul>
<li>允许自动攻击，例如撞库，其中攻击者拥有有效用户名和密码的列表。</li>
<li>允许蛮力或其他自动攻击。</li>
<li>允许使用默认密码、弱密码或众所周知的密码，例如“Password1”或“admin/admin”。</li>
<li>使用薄弱或无效的凭据恢复和忘记密码流程，例如无法确保安全的“基于知识的答案”。</li>
<li>使用纯文本、加密或弱散列密码数据存储（请参阅 <strong>A02:2021-加密失败</strong>）。</li>
<li>缺少或无效的多因素身份验证。</li>
<li>在 URL 中公开会话标识符。</li>
<li>成功登录后重用会话标识符。</li>
<li>不会正确地使会话 ID 无效。用户会话或身份验证令牌（主要是单点登录 (SSO) 令牌）在注销或一段时间不活动期间未正确失效。</li>
</ul>
<h2 id="如何预防-6"><a href="#如何预防-6" class="headerlink" title="如何预防"></a>如何预防</h2><ul>
<li>在可能的情况下，实施多因素身份验证以防止自动凭证填充、暴力破解和被盗凭证重用攻击。</li>
<li>不要使用任何默认凭据进行交付或部署，尤其是对于管理员用户。</li>
<li>实施弱密码检查，例如针对前 10,000 个最差密码列表测试新密码或更改密码。</li>
<li>将密码长度、复杂性和轮换策略与美国国家标准与技术研究院 (NIST) 800-63b 的第 5.1.1 节中关于记忆秘密的指南或其他现代的、基于证据的密码策略保持一致。</li>
<li>通过对所有结果使用相同的消息，确保注册、凭证恢复和 API 路径能够抵御帐户枚举攻击。</li>
<li>限制或逐渐延迟失败的登录尝试，但注意不要造成拒绝服务场景。当检测到凭证填充、暴力破解或其他攻击时，记录所有故障并提醒管理员。</li>
<li>使用服务器端、安全、内置的会话管理器，在登录后生成新的高熵随机会话 ID。会话标识符不应在 URL 中，应安全存储，并在注销、空闲和绝对超时后失效。</li>
</ul>
<h2 id="示例攻击场景-6"><a href="#示例攻击场景-6" class="headerlink" title="示例攻击场景"></a>示例攻击场景</h2><p><strong>场景#1：</strong>凭证填充（使用已知密码列表）是一种常见的攻击。假设应用程序没有实施自动化威胁或凭证填充保护。在这种情况下，应用程序可以用作密码预言机来确定凭据是否有效。</p>
<p><strong>场景#2：</strong>大多数身份验证攻击是由于继续使用密码作为唯一因素而发生的。一经考虑，最佳实践、密码轮换和复杂性要求会鼓励用户使用和重复使用弱密码。建议组织按照 NIST 800-63 停止这些做法并使用多因素身份验证。</p>
<p><strong>场景 #3：</strong>应用程序会话超时设置不正确。用户使用公共计算机访问应用程序。用户没有选择“注销”，而是简单地关闭浏览器选项卡并走开。攻击者在一个小时后使用同一个浏览器，而用户仍然通过身份验证。</p>
<h1 id="A08-2021-–-软件和数据完整性故障"><a href="#A08-2021-–-软件和数据完整性故障" class="headerlink" title="A08:2021 – 软件和数据完整性故障"></a>A08:2021 – 软件和数据完整性故障</h1><p><img src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211202151700.png" alt="图标"></p>
<h2 id="因素-7"><a href="#因素-7" class="headerlink" title="因素"></a>因素</h2><table>
<thead>
<tr>
<th>映射的 CWE</th>
<th>最大发生率</th>
<th>平均发生率</th>
<th>平均加权漏洞利用</th>
<th>平均加权影响</th>
<th>最大覆盖范围</th>
<th>平均覆盖率</th>
<th>总发生次数</th>
<th>CVE 总数</th>
</tr>
</thead>
<tbody><tr>
<td>10</td>
<td>16.67%</td>
<td>2.05%</td>
<td>6.94</td>
<td>7.94</td>
<td>75.04%</td>
<td>45.35%</td>
<td>47,972</td>
<td>1,152</td>
</tr>
</tbody></table>
<h2 id="概述-7"><a href="#概述-7" class="headerlink" title="概述"></a>概述</h2><p>2021 年的新类别侧重于在不验证完整性的情况下做出与软件更新、关键数据和 CI/CD 管道相关的假设。来自常见漏洞和暴露/常见漏洞评分系统 (CVE/CVSS) 数据的最高加权影响之一。值得注意的常见弱点枚举 ( <em>CWE</em> ) 包括 <em>CWE-829：包含不受信任的控制领域的功能</em>、 <em>CWE-494：不进行完整性检查的代码下载</em>和 <em>CWE-502：不受信任数据的反序列化</em>。</p>
<h2 id="描述-7"><a href="#描述-7" class="headerlink" title="描述"></a>描述</h2><p>软件和数据完整性故障与不能防止完整性违规的代码和基础设施有关。一个例子是应用程序依赖来自不受信任的来源、存储库和内容交付网络 (CDN) 的插件、库或模块。不安全的 CI/CD 管道可能会导致未经授权的访问、恶意代码或系统受损。最后，许多应用程序现在包括自动更新功能，其中更新在没有充分完整性验证的情况下被下载并应用于以前受信任的应用程序。攻击者可能会上传自己的更新以分发并在所有安装上运行。另一个例子是对象或数据被编码或序列化为攻击者可以看到和修改的结构，容易受到不安全的反序列化。</p>
<h2 id="如何预防-7"><a href="#如何预防-7" class="headerlink" title="如何预防"></a>如何预防</h2><ul>
<li>使用数字签名或类似机制来验证软件或数据来自预期来源且未被更改。</li>
<li>确保库和依赖项（例如 npm 或 Maven）正在使用受信任的存储库。如果您有更高的风险状况，请考虑托管经过审查的内部已知良好存储库。</li>
<li>确保使用软件供应链安全工具（例如 OWASP Dependency Check 或 OWASP CycloneDX）来验证组件不包含已知漏洞</li>
<li>确保对代码和配置更改有一个审查过程，以最大限度地减少恶意代码或配置可能被引入您的软件管道的机会。</li>
<li>确保您的 CI/CD 管道具有适当的隔离、配置和访问控制，以确保流经构建和部署过程的代码的完整性。</li>
<li>确保未签名或未加密的序列化数据不会在没有某种形式的完整性检查或数字签名的情况下发送到不受信任的客户端，以检测序列化数据的篡改或重放</li>
</ul>
<h2 id="示例攻击场景-7"><a href="#示例攻击场景-7" class="headerlink" title="示例攻击场景"></a>示例攻击场景</h2><p><strong>场景 #1 无需签名即可更新：</strong>许多家用路由器、机顶盒、设备固件等不通过签名固件验证更新。未签名固件是攻击者越来越多的目标，预计只会变得更糟。这是一个主要问题，因为很多时候除了在未来的版本中修复并等待以前的版本过时之外，没有任何补救机制。</p>
<p><strong>场景#2 SolarWinds 恶意更新</strong>：众所周知，民族国家会攻击更新机制，最近一次值得注意的攻击是 SolarWinds Orion 攻击。开发该软件的公司拥有安全的构建和更新完整性流程。尽管如此，这些还是能够被破坏，并且在几个月的时间里，该公司向 18,000 多个组织分发了一个高度针对性的恶意更新，其中大约 100 个组织受到了影响。这是历史上这种性质的最深远和最重要的违规行为之一。</p>
<p><strong>场景 #3 不安全的反序列化：</strong> React 应用程序调用一组 Spring Boot 微服务。作为函数式程序员，他们试图确保他们的代码是不可变的。他们提出的解决方案是序列化用户状态并在每个请求中来回传递它。攻击者注意到“rO0”Java 对象签名（base64 格式）并使用 Java Serial Killer 工具在应用程序服务器上获取远程代码执行权。</p>
<h1 id="A09-2021-–-安全日志记录和监控失败"><a href="#A09-2021-–-安全日志记录和监控失败" class="headerlink" title="A09:2021 – 安全日志记录和监控失败"></a>A09:2021 – 安全日志记录和监控失败</h1><p><img src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211202151700.png"></p>
<h2 id="因素-8"><a href="#因素-8" class="headerlink" title="因素"></a>因素</h2><table>
<thead>
<tr>
<th>映射的 CWE</th>
<th>最大发生率</th>
<th>平均发生率</th>
<th>平均加权漏洞利用</th>
<th>平均加权影响</th>
<th>最大覆盖范围</th>
<th>平均覆盖率</th>
<th>总发生次数</th>
<th>CVE 总数</th>
</tr>
</thead>
<tbody><tr>
<td>4</td>
<td>19.23%</td>
<td>6.51%</td>
<td>6.87</td>
<td>4.99</td>
<td>53.67%</td>
<td>39.97%</td>
<td>53,615</td>
<td>242</td>
</tr>
</tbody></table>
<h2 id="概述-8"><a href="#概述-8" class="headerlink" title="概述"></a>概述</h2><p>安全日志记录和监控来自 Top 10 社区调查（#3），比 OWASP Top 10 2017 中的第十位略有上升。 日志记录和监控可能难以测试，通常涉及采访或询问是否在渗透过程中检测到攻击测试。此类别的 CVE/CVSS 数据不多，但检测和响应漏洞至关重要。尽管如此，它仍然对问责制、可见性、事件警报和取证非常有影响。此类别扩展到<em>CWE-778 日志记录不足</em>之外，包括<em>CWE-117 日志的不当输出中和</em>、<em>CWE-223 安全相关信息的遗漏</em>和 <em>CWE-532</em> <em>将敏感信息插入日志文件</em>。</p>
<h2 id="描述-8"><a href="#描述-8" class="headerlink" title="描述"></a>描述</h2><p>回到 2021 年 OWASP 前 10 名，该类别旨在帮助检测、升级和响应主动违规行为。如果没有日志记录和监控，就无法检测到漏洞。任何时候都会发生记录、检测、监控和主动响应不足的情况：</p>
<ul>
<li>不记录可审计事件，例如登录、登录失败和高价值交易。</li>
<li>警告和错误不会生成、不充分或不清楚的日志消息。</li>
<li>不会监控应用程序和 API 的日志是否存在可疑活动。</li>
<li>日志仅存储在本地。</li>
<li>适当的警报阈值和响应升级过程没有到位或有效。</li>
<li>动态应用程序安全测试 (DAST) 工具（例如 OWASP ZAP）的渗透测试和扫描不会触发警报。</li>
<li>应用程序无法实时或接近实时地检测、升级或警告主动攻击。</li>
</ul>
<p>通过使用户或攻击者可以看到日志记录和警报事件，您很容易受到信息泄漏的影响（请参阅<a target="_blank" rel="noopener" href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">A01:2021-Broken Access Control</a>）。</p>
<h2 id="如何预防-8"><a href="#如何预防-8" class="headerlink" title="如何预防"></a>如何预防</h2><p>开发人员应根据应用程序的风险实施以下部分或全部控制：</p>
<ul>
<li>确保可以记录所有登录、访问控制和服务器端输入验证失败，并使用足够的用户上下文来识别可疑或恶意帐户，并保留足够的时间以允许延迟取证分析。</li>
<li>确保以日志管理解决方案可以轻松使用的格式生成日志。</li>
<li>确保日志数据编码正确，以防止对日志或监控系统的注入或攻击。</li>
<li>确保高价值交易具有带有完整性控制的审计跟踪，以防止篡改或删除，例如仅追加数据库表或类似的。</li>
<li>DevSecOps 团队应该建立有效的监控和警报，以便快速检测和响应可疑活动。</li>
<li>制定或采用事件响应和恢复计划，例如美国国家标准与技术研究院 (NIST) 800-61r2 或更高版本。</li>
</ul>
<p>有商业和开源应用程序保护框架，例如 OWASP ModSecurity 核心规则集，以及开源日志关联软件，例如 Elasticsearch、Logstash、Kibana (ELK) 堆栈，它们具有自定义仪表板和警报功能。</p>
<h2 id="示例攻击场景-8"><a href="#示例攻击场景-8" class="headerlink" title="示例攻击场景"></a>示例攻击场景</h2><p><strong>场景#1：</strong>由于缺乏监控和日志记录，一家儿童健康计划提供商的网站运营商无法检测到违规行为。外部方通知健康计划提供者，攻击者访问并修改了超过 350 万儿童的数千份敏感健康记录。事后审查发现网站开发人员没有解决重大漏洞。由于没有对系统进行日志记录或监控，数据泄露可能自 2013 年以来一直在进行，时间超过七年。</p>
<p><strong>场景#2：</strong>印度一家大型航空公司发生数据泄露事件，涉及数百万乘客十多年的个人数据，包括护照和信用卡数据。数据泄露发生在第三方云托管服务提供商处，该提供商在一段时间后将泄露事件通知了航空公司。</p>
<p><strong>场景 #3：</strong>一家主要的欧洲航空公司遭遇了 GDPR 可报告的违规行为。据报道，该漏洞是由攻击者利用的支付应用程序安全漏洞引起的，他们收集了超过 400,000 条客户支付记录。该航空公司因此被隐私监管机构罚款 2000 万英镑。</p>
<h1 id="A10-2021-–-服务器端请求伪造-SSRF"><a href="#A10-2021-–-服务器端请求伪造-SSRF" class="headerlink" title="A10:2021 – 服务器端请求伪造 (SSRF)"></a>A10:2021 – 服务器端请求伪造 (SSRF)</h1><p><img src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211202151654.png" alt="图标"></p>
<h2 id="因素-9"><a href="#因素-9" class="headerlink" title="因素"></a>因素</h2><table>
<thead>
<tr>
<th>映射的 CWE</th>
<th>最大发生率</th>
<th>平均发生率</th>
<th>平均加权漏洞利用</th>
<th>平均加权影响</th>
<th>最大覆盖范围</th>
<th>平均覆盖率</th>
<th>总发生次数</th>
<th>CVE 总数</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>2.72%</td>
<td>2.72%</td>
<td>8.28</td>
<td>6.72</td>
<td>67.72%</td>
<td>67.72%</td>
<td>9,503</td>
<td>385</td>
</tr>
</tbody></table>
<h2 id="概述-9"><a href="#概述-9" class="headerlink" title="概述"></a>概述</h2><p>此类别是从前 10 名社区调查 (#1) 中添加的。数据显示发生率相对较低，测试覆盖率高于平均水平，利用和影响潜力评级高于平均水平。由于新条目可能是单个或一小群常见弱点枚举 (CWE)，以引起注意和意识，因此希望它们受到关注，并且可以在未来版本中归入更大的类别。</p>
<h2 id="描述-9"><a href="#描述-9" class="headerlink" title="描述"></a>描述</h2><p>每当 Web 应用程序在未验证用户提供的 URL 的情况下获取远程资源时，就会出现 SSRF 缺陷。它允许攻击者强制应用程序将精心设计的请求发送到意外目的地，即使受到防火墙、VPN 或其他类型的网络访问控制列表 (ACL) 的保护也是如此。</p>
<p>随着现代 Web 应用程序为最终用户提供方便的功能，获取 URL 成为一种常见情况。因此，SSRF 的发病率正在增加。此外，由于云服务和架构的复杂性，SSRF 的严重性越来越高。</p>
<h2 id="如何预防-9"><a href="#如何预防-9" class="headerlink" title="如何预防"></a>如何预防</h2><p>开发人员可以通过实施以下部分或全部深度防御控制来防止 SSRF：</p>
<h3 id="从网络层"><a href="#从网络层" class="headerlink" title="从网络层"></a><strong>从网络层</strong></h3><ul>
<li>在单独的网络中分段远程资源访问功能以减少 SSRF 的影响</li>
<li>强制执行“默认拒绝”防火墙策略或网络访问控制规则，以阻止除基本的 Intranet 流量之外的所有流量。<br><em>提示：</em><br>~ 为基于应用程序的防火墙规则建立所有权和生命周期。<br>~在防火墙上记录所有接受<em>和</em>阻止的网络流量（请参阅<a target="_blank" rel="noopener" href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">A09:2021-安全日志记录和监控失败</a>）。</li>
</ul>
<h3 id="从应用层："><a href="#从应用层：" class="headerlink" title="从应用层："></a><strong>从应用层：</strong></h3><ul>
<li>清理和验证所有客户端提供的输入数据</li>
<li>使用肯定的允许列表强制执行 URL 架构、端口和目标</li>
<li>不要向客户端发送原始响应</li>
<li>禁用 HTTP 重定向</li>
<li>注意 URL 一致性，以避免 DNS 重新绑定和“检查时间、使用时间”(TOCTOU) 竞争条件等攻击</li>
</ul>
<p>不要通过使用拒绝列表或正则表达式来缓解 SSRF。攻击者拥有有效负载列表、工具和技能来绕过拒绝列表。</p>
<h2 id="需要考虑的额外措施："><a href="#需要考虑的额外措施：" class="headerlink" title="需要考虑的额外措施："></a><strong>需要考虑的额外措施：</strong></h2><ul>
<li>不要在前端系统（例如 OpenID）上部署其他安全相关服务。控制这些系统上的本地流量（例如本地主机）</li>
<li>对于具有专用和可管理用户组的前端，在独立系统上使用网络加密（例如 VPN）来考虑非常高的保护需求</li>
</ul>
<h2 id="示例攻击场景-9"><a href="#示例攻击场景-9" class="headerlink" title="示例攻击场景"></a>示例攻击场景</h2><p>攻击者可以使用 SSRF 攻击受 Web 应用程序防火墙、防火墙或网络 ACL 保护的系统，使用的场景包括：</p>
<p><strong>场景#1：</strong>端口扫描内部服务器——如果网络架构是未分段的，攻击者可以绘制出内部网络，并根据连接结果或连接或拒绝 SSRF 负载连接所用的时间来确定内部服务器上的端口是打开还是关闭。</p>
<p><strong>场景#2：</strong>敏感数据暴露——攻击者可以访问本地文件或内部服务来获取敏感信息，如<code>file:///etc/passwd&lt;/span&gt;</code>和<code>http://localhost:28017/</code>。</p>
<p><strong>场景#3：</strong>访问云服务的元数据存储——大多数云提供商都有元数据存储，例如<code>http://169.254.169.254/</code>. 攻击者可以读取元数据来获取敏感信息。</p>
<p><strong>场景#4：</strong>破坏内部服务——攻击者可以滥用内部服务进行进一步的攻击，例如远程代码执行 (RCE) 或拒绝服务 (DoS)。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">FakerCsr</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://fakercsr.github.io/posts/96e3061b/">http://fakercsr.github.io/posts/96e3061b/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://FakerCsr.github.io" target="_blank">FakerCsr's Magic Box</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/">信息安全</a><a class="post-meta__tags" href="/tags/%E6%BC%8F%E6%B4%9E%E4%BB%8B%E7%BB%8D/">漏洞介绍</a></div><div class="post_share"><div class="social-share" data-image="https://www.traceable.ai/wp-content/uploads/2021/09/6039c84e695ede694324b40d_owaspcode-1.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/b42f4bd7/"><img class="prev-cover" src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211202150620.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">vulnhub DC1 靶场练习</div></div></a></div><div class="next-post pull-right"><a href="/posts/79666db/"><img class="next-cover" src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211129193028.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">数据结构</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/289d493d/" title="CTFshow-web入门-信息搜集"><img class="cover" src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211014202000.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-06</div><div class="title">CTFshow-web入门-信息搜集</div></div></a></div><div><a href="/posts/ecd8242f/" title="CTFshow-web入门-命令执行"><img class="cover" src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211014202005.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-08</div><div class="title">CTFshow-web入门-命令执行</div></div></a></div><div><a href="/posts/24486494/" title="CTF命令执行与绕过"><img class="cover" src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211029183532.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-29</div><div class="title">CTF命令执行与绕过</div></div></a></div><div><a href="/posts/528a1924/" title="GXYCTF2019_Ping Ping Ping"><img class="cover" src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211013131644.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-01-29</div><div class="title">GXYCTF2019_Ping Ping Ping</div></div></a></div><div><a href="/posts/bb34e501/" title="Easy File Sharing Web Server 漏洞的简单利用"><img class="cover" src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211013131617.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-04</div><div class="title">Easy File Sharing Web Server 漏洞的简单利用</div></div></a></div><div><a href="/posts/145c0a80/" title="SQL入门题[极客大挑战 2019]"><img class="cover" src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211014202155.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-06</div><div class="title">SQL入门题[极客大挑战 2019]</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/./img/loading.gif" data-lazy-src="http://q1.qlogo.cn/g?b=qq&amp;nk=979280582&amp;s=640" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">FakerCsr</div><div class="author-info__description">Welcome to Magic Box</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">21</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">17</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/FackCsr" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/979280582@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#OWASP-TOP-10"><span class="toc-number">1.</span> <span class="toc-text">OWASP TOP 10</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E5%A4%A7-Web-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%AE%89%E5%85%A8%E9%A3%8E%E9%99%A9"><span class="toc-number">2.</span> <span class="toc-text">十大 Web 应用程序安全风险</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#A01-2021-%E2%80%93-%E6%8D%9F%E5%9D%8F%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">3.</span> <span class="toc-text">A01:2021 – 损坏的访问控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0"><span class="toc-number">3.1.</span> <span class="toc-text">因素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">3.2.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0"><span class="toc-number">3.3.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%A2%84%E9%98%B2"><span class="toc-number">3.4.</span> <span class="toc-text">如何预防</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF"><span class="toc-number">3.5.</span> <span class="toc-text">示例攻击场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#A02-2021-%E2%80%93-%E5%8A%A0%E5%AF%86%E5%A4%B1%E8%B4%A5"><span class="toc-number">4.</span> <span class="toc-text">A02:2021 – 加密失败</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0-1"><span class="toc-number">4.1.</span> <span class="toc-text">因素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-1"><span class="toc-number">4.2.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0-1"><span class="toc-number">4.3.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%A2%84%E9%98%B2-1"><span class="toc-number">4.4.</span> <span class="toc-text">如何预防</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF-1"><span class="toc-number">4.5.</span> <span class="toc-text">示例攻击场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#A03-2021-%E2%80%93-%E6%B3%A8%E5%B0%84"><span class="toc-number">5.</span> <span class="toc-text">A03:2021 – 注射</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0-2"><span class="toc-number">5.1.</span> <span class="toc-text">因素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-2"><span class="toc-number">5.2.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0-2"><span class="toc-number">5.3.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%A2%84%E9%98%B2-2"><span class="toc-number">5.4.</span> <span class="toc-text">如何预防</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF-2"><span class="toc-number">5.5.</span> <span class="toc-text">示例攻击场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#A04-2021-%E2%80%93-%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">6.</span> <span class="toc-text">A04:2021 – 不安全的设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0-3"><span class="toc-number">6.1.</span> <span class="toc-text">因素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-3"><span class="toc-number">6.2.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0-3"><span class="toc-number">6.3.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%92%8C%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86"><span class="toc-number">6.4.</span> <span class="toc-text">需求和资源管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E8%AE%BE%E8%AE%A1"><span class="toc-number">6.5.</span> <span class="toc-text">安全设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E5%BC%80%E5%8F%91%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">6.6.</span> <span class="toc-text">安全开发生命周期</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%A2%84%E9%98%B2-3"><span class="toc-number">6.7.</span> <span class="toc-text">如何预防</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF-3"><span class="toc-number">6.8.</span> <span class="toc-text">示例攻击场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#A05-2021-%E2%80%93-%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF"><span class="toc-number">7.</span> <span class="toc-text">A05:2021 – 安全配置错误</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0-4"><span class="toc-number">7.1.</span> <span class="toc-text">因素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-4"><span class="toc-number">7.2.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0-4"><span class="toc-number">7.3.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%A2%84%E9%98%B2-4"><span class="toc-number">7.4.</span> <span class="toc-text">如何预防</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF-4"><span class="toc-number">7.5.</span> <span class="toc-text">示例攻击场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#A06-2021-%E2%80%93-%E6%98%93%E5%8F%97%E6%94%BB%E5%87%BB%E5%92%8C%E8%BF%87%E6%97%B6%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="toc-number">8.</span> <span class="toc-text">A06:2021 – 易受攻击和过时的组件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0-5"><span class="toc-number">8.1.</span> <span class="toc-text">因素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-5"><span class="toc-number">8.2.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0-5"><span class="toc-number">8.3.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%A2%84%E9%98%B2-5"><span class="toc-number">8.4.</span> <span class="toc-text">如何预防</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF-5"><span class="toc-number">8.5.</span> <span class="toc-text">示例攻击场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#A07-2021-%E2%80%93-%E8%AF%86%E5%88%AB%E5%92%8C%E8%AE%A4%E8%AF%81%E5%A4%B1%E8%B4%A5"><span class="toc-number">9.</span> <span class="toc-text">A07:2021 – 识别和认证失败</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0-6"><span class="toc-number">9.1.</span> <span class="toc-text">因素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-6"><span class="toc-number">9.2.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0-6"><span class="toc-number">9.3.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%A2%84%E9%98%B2-6"><span class="toc-number">9.4.</span> <span class="toc-text">如何预防</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF-6"><span class="toc-number">9.5.</span> <span class="toc-text">示例攻击场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#A08-2021-%E2%80%93-%E8%BD%AF%E4%BB%B6%E5%92%8C%E6%95%B0%E6%8D%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E6%95%85%E9%9A%9C"><span class="toc-number">10.</span> <span class="toc-text">A08:2021 – 软件和数据完整性故障</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0-7"><span class="toc-number">10.1.</span> <span class="toc-text">因素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-7"><span class="toc-number">10.2.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0-7"><span class="toc-number">10.3.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%A2%84%E9%98%B2-7"><span class="toc-number">10.4.</span> <span class="toc-text">如何预防</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF-7"><span class="toc-number">10.5.</span> <span class="toc-text">示例攻击场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#A09-2021-%E2%80%93-%E5%AE%89%E5%85%A8%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E5%92%8C%E7%9B%91%E6%8E%A7%E5%A4%B1%E8%B4%A5"><span class="toc-number">11.</span> <span class="toc-text">A09:2021 – 安全日志记录和监控失败</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0-8"><span class="toc-number">11.1.</span> <span class="toc-text">因素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-8"><span class="toc-number">11.2.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0-8"><span class="toc-number">11.3.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%A2%84%E9%98%B2-8"><span class="toc-number">11.4.</span> <span class="toc-text">如何预防</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF-8"><span class="toc-number">11.5.</span> <span class="toc-text">示例攻击场景</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#A10-2021-%E2%80%93-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0-SSRF"><span class="toc-number">12.</span> <span class="toc-text">A10:2021 – 服务器端请求伪造 (SSRF)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%A0%E7%B4%A0-9"><span class="toc-number">12.1.</span> <span class="toc-text">因素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0-9"><span class="toc-number">12.2.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%8F%E8%BF%B0-9"><span class="toc-number">12.3.</span> <span class="toc-text">描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%A2%84%E9%98%B2-9"><span class="toc-number">12.4.</span> <span class="toc-text">如何预防</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">12.4.1.</span> <span class="toc-text">从网络层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E5%BA%94%E7%94%A8%E5%B1%82%EF%BC%9A"><span class="toc-number">12.4.2.</span> <span class="toc-text">从应用层：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E8%80%83%E8%99%91%E7%9A%84%E9%A2%9D%E5%A4%96%E6%8E%AA%E6%96%BD%EF%BC%9A"><span class="toc-number">12.5.</span> <span class="toc-text">需要考虑的额外措施：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF-9"><span class="toc-number">12.6.</span> <span class="toc-text">示例攻击场景</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/b93b1d5c/" title="概率论复习"><img src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211209174907.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="概率论复习"/></a><div class="content"><a class="title" href="/posts/b93b1d5c/" title="概率论复习">概率论复习</a><time datetime="2021-12-09T09:48:17.000Z" title="发表于 2021-12-09 17:48:17">2021-12-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/b42f4bd7/" title="vulnhub DC1 靶场练习"><img src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211202150620.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="vulnhub DC1 靶场练习"/></a><div class="content"><a class="title" href="/posts/b42f4bd7/" title="vulnhub DC1 靶场练习">vulnhub DC1 靶场练习</a><time datetime="2021-12-06T10:08:16.000Z" title="发表于 2021-12-06 18:08:16">2021-12-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/96e3061b/" title="OWASP TOP 10"><img src= "/./img/loading.gif" data-lazy-src="https://www.traceable.ai/wp-content/uploads/2021/09/6039c84e695ede694324b40d_owaspcode-1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OWASP TOP 10"/></a><div class="content"><a class="title" href="/posts/96e3061b/" title="OWASP TOP 10">OWASP TOP 10</a><time datetime="2021-12-02T07:07:59.000Z" title="发表于 2021-12-02 15:07:59">2021-12-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/79666db/" title="数据结构"><img src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211129193028.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构"/></a><div class="content"><a class="title" href="/posts/79666db/" title="数据结构">数据结构</a><time datetime="2021-11-29T11:29:17.000Z" title="发表于 2021-11-29 19:29:17">2021-11-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dcf89a2e/" title="DeceCMS v5.7 SP2正式版前台任意修改用户密码修改漏洞复现"><img src= "/./img/loading.gif" data-lazy-src="https://gitee.com/csrcsyh/note/raw/master/img/20211123134345.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DeceCMS v5.7 SP2正式版前台任意修改用户密码修改漏洞复现"/></a><div class="content"><a class="title" href="/posts/dcf89a2e/" title="DeceCMS v5.7 SP2正式版前台任意修改用户密码修改漏洞复现">DeceCMS v5.7 SP2正式版前台任意修改用户密码修改漏洞复现</a><time datetime="2021-11-23T05:42:39.000Z" title="发表于 2021-11-23 13:42:39">2021-11-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By FakerCsr</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'M5w43MvVYoiXPql8oo3RpJy4-gzGzoHsz',
      appKey: 'm85538OpXW57GohesiYS4mVT',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script type="text/javascript" src="./js/my.js"></script><div class="app-refresh" id="app-refresh"> <div class="app-refresh-wrap"> <label>✨ 网站已更新最新版本 👉</label> <a href="javascript:void(0)" onclick="location.reload()">点击刷新</a> </div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"已更新最新版本",backgroundColor:t,duration:5e5,pos:e,actionText:"点击刷新",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",function(){showNotification()}),window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js")}));</script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>